"use strict";(self.webpackChunkdoks=self.webpackChunkdoks||[]).push([[1437],{66733:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>a,default:()=>u,frontMatter:()=>r,metadata:()=>s,toc:()=>d});var i=n(85893),o=n(11151);const r={id:"app",title:"Nextflow",sidebar_label:"Nextflow",sidebar_position:1},a="Nextflow",s={id:"roadmap/app",title:"Nextflow",description:"While we are going to continue to build and improve our visual workflow editor for streaming wokrlfow, we also want to make sure that Arkitekt Apps are",source:"@site/docs/roadmap/nextflow.mdx",sourceDirName:"roadmap",slug:"/roadmap/app",permalink:"/docs/roadmap/app",draft:!1,unlisted:!1,editUrl:"https://github.com/arkitektio/arkitektio.github.io/edit/master/docs/roadmap/nextflow.mdx",tags:[],version:"current",sidebarPosition:1,frontMatter:{id:"app",title:"Nextflow",sidebar_label:"Nextflow",sidebar_position:1},sidebar:"tutorialSidebar",previous:{title:"Roadmap",permalink:"/docs/roadmap/"}},l={},d=[{value:"What could be the way forward?",id:"what-could-be-the-way-forward",level:2},{value:"1. Calling Arkitekt Apps from Nextflow",id:"1-calling-arkitekt-apps-from-nextflow",level:3},{value:"2. Running Arkitekt Apps inside of Nextflow",id:"2-running-arkitekt-apps-inside-of-nextflow",level:3},{value:"3. Running Arkitekt Apps inside of Nextflow, and using the Nextflow data infrastructure",id:"3-running-arkitekt-apps-inside-of-nextflow-and-using-the-nextflow-data-infrastructure",level:3},{value:"What do you think?",id:"what-do-you-think",level:2}];function h(e){const t={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,o.a)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.h1,{id:"nextflow",children:"Nextflow"}),"\n",(0,i.jsxs)(t.p,{children:["While we are going to continue to build and improve our visual workflow editor for streaming wokrlfow, we also want to make sure that Arkitekt Apps are\naccessible to everyone that is already using other workflow languages. To that end, we would like Arkitekt Apps to be run inside of Nextflow workflows,\njust like any other process. Why one would choose to use Nextflow over Arkitekt is a different question, and we are discussing some points in the\n",(0,i.jsx)(t.a,{href:"/docs/design/vs/nextflow",children:"Nextflow vs Arkitekt"})," page."]}),"\n",(0,i.jsx)(t.h2,{id:"what-could-be-the-way-forward",children:"What could be the way forward?"}),"\n",(0,i.jsx)(t.p,{children:"This really depends on how we want to integrate Arkitekt Apps with Nextflow. There are a few options, and we would be\nhappy to discuss which one would be the best. We are also open to other options that we might not have thought about."}),"\n",(0,i.jsx)(t.h3,{id:"1-calling-arkitekt-apps-from-nextflow",children:"1. Calling Arkitekt Apps from Nextflow"}),"\n",(0,i.jsxs)(t.p,{children:["This is the simplest way of doing it, and would just replace the Workflow Scheduling part of Arkitekt Apps with Nextflow. This would mean that\nArkitekt Apps could still run on their specific resources but would be called through Rekuest by Nextflow. This could be done by creating a\nNextflow process that would just call ",(0,i.jsx)(t.code,{children:"arkitekt call remote $NODE_NAME"})," and then wait for this call to finish. This would be the simplest way\nof integrating Arkitekt Apps with Nextflow."]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-groovy",children:'\nprocess maximum_intensity {\n    input:\n    val image_id from params.image_id\n    output:\n    val output_image_id from stdout()\n    script:\n    """\n    arkitekt call remote maximum_intensity $image_name\n    """\n}\n'})}),"\n",(0,i.jsx)(t.p,{children:"This way of integration should already work. But it would be nice to have a more integrated way of doing it, where we could create\nthe process definition directly from a Node definition. This should be pretty straightforward to do."}),"\n",(0,i.jsx)(t.p,{children:"A few advantages:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:"Simple to implement"}),"\n",(0,i.jsx)(t.li,{children:"Would not require any chances to the system"}),"\n",(0,i.jsx)(t.li,{children:"Latency would be low, as the Arkitekt App would continuesly be running on the Arkitekt resources"}),"\n"]}),"\n",(0,i.jsx)(t.p,{children:"A few disadvantages:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:"Would require the data to be stored in the Arkitekt Ecosystem"}),"\n",(0,i.jsx)(t.li,{children:"Would require remote calls to an Arkitekt server, which could add another point\nof failure"}),"\n"]}),"\n",(0,i.jsx)(t.h3,{id:"2-running-arkitekt-apps-inside-of-nextflow",children:"2. Running Arkitekt Apps inside of Nextflow"}),"\n",(0,i.jsxs)(t.p,{children:["As Arkitekt Apps are just Docker container, they shold be easily runnable inside of Nextflow. What would change is\nthat instead of starting the Arkitekt App with ",(0,i.jsx)(t.code,{children:"arkitekt run"}),", causing them to connect to a Rekuest server, we would start them with\n",(0,i.jsx)(t.code,{children:"arkitekt call local $NODE_NAME"})," which would cause them to run in local mode, and not connect to a Rekuest server, but still using the same\ndata infrastructure of the Arkitekt Ecosystem (connecting to Mikro or other data sources)."]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-groovy",children:'\nprocess maximum_intensity {\n    cotainer \'arkitekt/maximum_intensity\' # This would be the name of the Arkitekt App\n    input:\n    val image_id from params.image_id\n    output:\n    val output_image_id from stdout()\n    script:\n    """\n    arkitekt call local maximum_intensity $image_name\n    """\n}\n'})}),"\n",(0,i.jsx)(t.p,{children:"This would be a bit more complicated to do, but would allow us to use the Arkitekt Apps as if they were just another process in Nextflow.\nNo need to use Rekuest, or to have a Rekuest server running. This would also allow us to use the Arkitekt Apps in Nextflow pipelines that\nare not running on Arkitekt resources. However this would still mean that we are requiring the data to be stored in the Arkitekt Ecosystem."}),"\n",(0,i.jsx)(t.p,{children:"Also this integration should in theory work. But again a more integrated way of doing it would be nice."}),"\n",(0,i.jsx)(t.p,{children:"A few advantages:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:"Simple to implement"}),"\n",(0,i.jsx)(t.li,{children:"Would not require any chances to the system"}),"\n",(0,i.jsx)(t.li,{children:"Would not require remote calls to an Arkitekt server"}),"\n"]}),"\n",(0,i.jsx)(t.p,{children:"A few disadvantages:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:"Would require the data to be stored in the Arkitekt Ecosystem"}),"\n",(0,i.jsx)(t.li,{children:"Would cause a cold start of each Arkitekt App for each process run (this is standard\nfor Nextflow, but not for Arkitekt Apps)"}),"\n",(0,i.jsx)(t.li,{children:"Would not allow provenance tracking of calls to the Arkitekt Apps"}),"\n"]}),"\n",(0,i.jsx)(t.h3,{id:"3-running-arkitekt-apps-inside-of-nextflow-and-using-the-nextflow-data-infrastructure",children:"3. Running Arkitekt Apps inside of Nextflow, and using the Nextflow data infrastructure"}),"\n",(0,i.jsx)(t.p,{children:"This is the most complicated way of doing it, and its unclear if it would be worth it. But it would allow us to use the Arkitekt Apps\nin Nextflow pipelines that are not running using Rekuest, and also not requiring the data to be stored in the Arkitekt Ecosystem."}),"\n",(0,i.jsx)(t.p,{children:"Using the Nextflow data infrastructure would mean that instead of saving the data in the Arkitekt Ecosystem, we would have to hook (monkeypatch),\nall API calls to the Arkitekt Ecosystem, and instead of saving the data in the Arkitekt Ecosystem, we would save it to a folder inside the\ncontainer. While in theory this should be possible (by hooking into the Rath API), it would be a lot of work and would require a patch for every\ndatatype that we want to support. (e.g. saving Mikro Images as Zarr Files, or saving Mikro Tables as CSV files)."}),"\n",(0,i.jsx)(t.p,{children:"A few advantages:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:"Complete detachment from the Arkitekt Ecosystem"}),"\n"]}),"\n",(0,i.jsx)(t.p,{children:"A few disadvantages:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:"Would require a lot of work"}),"\n",(0,i.jsx)(t.li,{children:"Would null the efforts of providing type safe data structures\n(we would resort to passing files, which is what we were trying to avoid)"}),"\n",(0,i.jsx)(t.li,{children:"Would not allow provenance tracking of calls to the Arkitekt Apps"}),"\n"]}),"\n",(0,i.jsx)(t.h2,{id:"what-do-you-think",children:"What do you think?"}),"\n",(0,i.jsx)(t.p,{children:"We would love to hear your thoughts on this. Please let us know what you think :)"})]})}function u(e={}){const{wrapper:t}={...(0,o.a)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(h,{...e})}):h(e)}},11151:(e,t,n)=>{n.d(t,{Z:()=>s,a:()=>a});var i=n(67294);const o={},r=i.createContext(o);function a(e){const t=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function s(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:a(e.components),i.createElement(r.Provider,{value:t},e.children)}}}]);